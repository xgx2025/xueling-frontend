# 需求文档

## 简介

学灵智能学习网站的用户认证系统，支持用户通过邮箱进行注册和登录。系统提供安全的密码验证、邮箱验证码验证，以及用户会话管理功能。

## 术语表

- **系统（System）**: 学灵智能学习网站的用户认证模块
- **用户（User）**: 访问学灵网站并需要进行身份认证的个人
- **验证码（Verification_Code）**: 发送到用户邮箱的一次性验证码，用于验证邮箱所有权
- **会话令牌（Session_Token）**: 用户成功登录后系统颁发的身份凭证
- **邮箱（Email）**: 用户的电子邮件地址，作为唯一标识符
- **密码（Password）**: 用户设置的用于身份验证的秘密字符串

## 需求

### 需求 1: 用户注册

**用户故事:** 作为新用户，我想通过邮箱注册账号，以便我可以使用学灵平台的学习功能。

#### 验收标准

1. WHEN 用户提交注册表单 THEN 系统 SHALL 验证邮箱格式是否有效
2. WHEN 用户提交注册表单 THEN 系统 SHALL 验证密码和确认密码是否一致
3. WHEN 用户提交注册表单 THEN 系统 SHALL 验证邮箱验证码是否正确
4. WHEN 用户提交的邮箱已被注册 THEN 系统 SHALL 拒绝注册并提示邮箱已存在
5. WHEN 所有验证通过 THEN 系统 SHALL 创建新用户账号并返回成功消息
6. WHEN 注册成功 THEN 系统 SHALL 自动跳转到登录页面

### 需求 2: 邮箱验证码发送

**用户故事:** 作为用户，我想接收邮箱验证码，以便验证我的邮箱所有权。

#### 验收标准

1. WHEN 用户请求发送验证码 THEN 系统 SHALL 验证邮箱格式是否有效
2. WHEN 邮箱格式有效 THEN 系统 SHALL 向该邮箱发送验证码
3. WHEN 验证码发送成功 THEN 系统 SHALL 显示倒计时防止频繁请求
4. WHEN 用户在倒计时期间再次请求 THEN 系统 SHALL 拒绝请求并显示剩余时间
5. THE 验证码 SHALL 在发送后 5 分钟内有效

### 需求 3: 用户登录

**用户故事:** 作为已注册用户，我想通过邮箱和密码登录，以便访问我的学习账号。

#### 验收标准

1. WHEN 用户提交登录表单 THEN 系统 SHALL 验证邮箱格式是否有效
2. WHEN 用户提交登录表单 THEN 系统 SHALL 验证密码是否为空
3. WHEN 邮箱和密码正确 THEN 系统 SHALL 返回会话令牌
4. WHEN 邮箱或密码错误 THEN 系统 SHALL 返回错误提示且不泄露具体错误原因
5. WHEN 登录成功 THEN 系统 SHALL 保存会话令牌到本地存储
6. WHEN 登录成功 THEN 系统 SHALL 跳转到主页面

### 需求 4: 密码安全性

**用户故事:** 作为用户，我想设置安全的密码，以便保护我的账号安全。

#### 验收标准

1. THE 密码 SHALL 至少包含 6 个字符
2. WHEN 用户输入密码 THEN 系统 SHALL 实时显示密码强度提示
3. WHEN 用户提交弱密码 THEN 系统 SHALL 显示警告但允许继续
4. THE 系统 SHALL 在传输前对密码进行加密处理

### 需求 5: 表单验证和用户反馈

**用户故事:** 作为用户，我想获得清晰的表单验证反馈，以便我知道如何正确填写表单。

#### 验收标准

1. WHEN 用户输入无效数据 THEN 系统 SHALL 在字段旁显示具体错误信息
2. WHEN 用户提交表单失败 THEN 系统 SHALL 显示友好的错误提示
3. WHEN 用户提交表单成功 THEN 系统 SHALL 显示成功提示
4. WHEN 表单正在提交 THEN 系统 SHALL 显示加载状态并禁用提交按钮
5. THE 系统 SHALL 在用户失去焦点时验证单个字段

### 需求 6: 会话管理

**用户故事:** 作为用户，我想系统记住我的登录状态，以便我不需要每次访问都重新登录。

#### 验收标准

1. WHEN 用户成功登录 THEN 系统 SHALL 将会话令牌存储到 Pinia store
2. WHEN 用户成功登录 THEN 系统 SHALL 将会话令牌持久化到 localStorage
3. WHEN 用户刷新页面 THEN 系统 SHALL 从 localStorage 恢复会话状态
4. WHEN 会话令牌过期 THEN 系统 SHALL 清除会话并跳转到登录页
5. WHEN 用户登出 THEN 系统 SHALL 清除所有会话数据

### 需求 7: 响应式设计

**用户故事:** 作为用户，我想在不同设备上都能方便地使用登录注册功能，以便我可以随时随地访问学灵平台。

#### 验收标准

1. THE 登录注册页面 SHALL 在移动设备上正确显示
2. THE 登录注册页面 SHALL 在平板设备上正确显示
3. THE 登录注册页面 SHALL 在桌面设备上正确显示
4. WHEN 屏幕尺寸改变 THEN 系统 SHALL 自动调整布局

### 需求 8: API 集成

**用户故事:** 作为系统，我需要与后端 API 正确通信，以便完成用户认证流程。

#### 验收标准

1. WHEN 调用注册 API THEN 系统 SHALL 发送包含 email、password、confirmPassword、verificationCode 的请求
2. WHEN 调用登录 API THEN 系统 SHALL 发送包含 email、password、ip 的请求
3. WHEN API 返回错误 THEN 系统 SHALL 显示用户友好的错误信息
4. WHEN API 请求超时 THEN 系统 SHALL 显示超时提示并允许重试
5. THE 系统 SHALL 在请求头中包含必要的认证信息
